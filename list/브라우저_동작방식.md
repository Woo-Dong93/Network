# 브라우저 동작방식

### 1. 브라우저의 주요 기능

- 사용자가 선택한 자원을 서버에 요청하고 브라우저에 표현하는 것이다.

- 자원은 보통 HTML 문저지만 PDF나 이미지 등 다양한 형태로 오기도 한다.

- 자원의 주소는 URI

  - URI(Uniform Resource Identifier) 안에 URL(Locator)과 URN(name) 이 있다.
  - URL : 인터넷 상의 자원 위치를 나타낸다. 즉 웹 상에서 서비스를 제공하는 각 서버들에 있는 파일의 위치를 표기 한 것 ( http://blong.com/work/test.pdf  )
  - URI : 인터넷 상의 자원을 식별하기 위한 문자열로 구성,
    - 통합 자원 식별자
    - http://test.com/test.pdf?docid=111  => URI는 맞지만 URL은 아니다.
    - 쿼리 스트링의 값에 따라 결과가 달라지게 된다. 식별자의 역할을 하는 것

  - URN : 해당 리소스 위치정보가 아닌 실제 리소스의 이름을 사용하는 빙식
    - 콘텐츠를 이루는 한 리소스에 대해 그 리소스 위치에 영향을 받지 않는 이름 역할을 한다.
    - 리소스를 여기저기 옮겨도 문제없이 작동한다.
    - urn : isbn : 9788982814471

- HTML과 CSS 명세에 따라 HTML파일을 해석해서 표시해준다. (W3C의 표준에 의해서)



### 2. 브라우저의 기본 구조

![](../img/1.png)

- 사용자 인터페이스 : 주소표시줄, 이전/다음 버튼, 북마크 메뉴 등 요청한 페이지 보여주는 창을 제외한 나머지
- 브라우저 엔진 : 사용자 인터페이스와 렌더링 엔진사이의 동작을 제어

- 렌더링 엔진 : 요청한 콘텐츠를 표시, ex) html을 요청하면 html과 css를 파싱하여 화면에 표시
  - 통신 : HTTP 요청과 같은 네트워크 호출시 사용된다. 플랫폼 독립적인 인터페이스
  - UI 백엔드 : 콤보 박스와 창 같은 기본적인 장치를 그린다, OS 사용자 인터페이스 체계를 사용
  - 자바스크립트 해석기 : 자바스크립트 코드를 해석하고 실행
- 자료 저장소 : 쿠키 등 모든 종류의 자원을 하드 디스크에 저장한다.

=> 각 탭은 독립적인 프로세스로 처리된다.



### 2-1 렌더링 엔진

- 요청 받은 내용을 브라우저 화면에 표시한다.
- 파이어폭스 : 게코 엔진을 사용한다.
- 사파리와 크롬 : 웹킷 엔진을 사용한다.
  - 웹킷 : 최초 리눅스 플랫폼에서 동작하기 위해 제작된 오픈소스
- 동작과정

![](../img/2.png)

- HTML 문서를 파싱하고 콘텐츠 트리 내부에서 태그를 DOM 노드로 변환.
- 다음 외부 CSS파일과 함께 포함된 스타일 요소도 파싱
- 이를 바탕으로 스타일정보와 HTML 표시규칙인 **렌더트리**라고 부르는 트리 생성
- 렌더트리 생성이 끝나면 배치가 시작된다.
- 다음에 UI 백엔드에서 렌더 트리의 각노드를 가로지르며 형상을 만들어 내는 그리기 과정
  - 속도를 위해 HTML을 파싱할 때까지 기다리지 않고 배치와 그리기 과정 실행
  - 아래는 웹킷 예시

![](../img/3.png)

- 어태치먼트 : 렌더 트리 생성을 위해 DOM 노드와 시각 정보를 연결하는 과정